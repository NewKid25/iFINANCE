@model Group7_iFINANCEAPP.Models.ViewModels.TrialBalanceViewModel

@{
    ViewBag.Title = "Trial Balance";
}


<div class="container my-5">
    <div class="card shadow-sm rounded-4 p-5">
        <h2 class="text-center mb-4">Trial Balance</h2>

        <div class="search-bar" style="display: flex; flex-direction: column; align-items: flex-end;">
            @using (Html.BeginForm("TrialBalance", "Reports", FormMethod.Get, new { @class = "d-flex", role = "search", style = "margin-bottom: 20px;" }))
            {
                <div class="m-1">
                    <label for="after">After date:</label>
                    <input class="form-control me-2" type="date" name="after" value="@Request.QueryString["after"]" />
                </div>

                <div class="m-1">
                    <label for="before">Before date:</label>
                    <input class="form-control me-2" type="date" name="before" value="@Request.QueryString["before"]" />
                </div>

                <button class="btn btn-outline-success search-button" type="submit">Filter</button>
            }
        </div>

        <table class="table table-bordered table-hover align-middle">
            <thead class="table-light">
                <tr>
                    <th>Account Name</th>
                    <th class="text-end">Debit Amount</th>
                    <th class="text-end">Credit Amount</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var lineItem in Model.lineItems)
                {
                    <tr>
                        <td>@lineItem.accountName</td>
                        <td class="text-end">@((lineItem.debit == null) ? "" : $"${Math.Round(lineItem.debit ?? 0.0, 2):0.00}")</td>
                        <td class="text-end">@((lineItem.credit == null) ? "" : $"${Math.Round(lineItem.credit ?? 0.0, 2):0.00}")</td>
                    </tr>

                }
                <tr class="fw-bold table-light">
                    <td>Total</td>
                    <td class="text-end">@Model.totalDebit.ToString("C")</td>
                    <td class="text-end">@Model.totalCredit.ToString("C")</td>
                </tr>
            </tbody>
        </table>


        @if (Model.totalDebit != Model.totalCredit)
        {
            <div class="alert alert-danger">
                <h4>Warning!</h4>
                <p>
                    It appears the sum of all debit accounts does not equal the sum of all credit accounts.
                    This is likely because you forgot to create an account, or to debit or credit an account in a
                    transaction properly. Reexamine your accounts and transactions to make sure you following
                    the double account methodology properly.
                </p>
            </div>
        }


        <div class="text-center mt-4">
            @Html.ActionLink("Back to Reports", "Index", "Reports", null, new { @class = "btn btn-primary" })
        </div>
    </div>
</div>

<style>

    .btn-primary {
        background-color: #8058ac;
        border-color: #8058ac;
    }

    .btn-primary:hover {
        background-color: #7048a0;
        border-color: #7048a0;
    }
</style>